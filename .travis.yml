language: java

jdk:
  - openjdk11

services:
  - docker

script:
  - cd server
  - ls -la
  - mvn clean package spring-boot:repackage  
  - docker build -t payroll-server .
  - docker images
  - docker login -u francobobadilla -p apich4594*
  - docker tag payroll-server francobobadilla/payroll-server:latest
  - docker push francobobadilla/payroll-server:latest
  - curl https://cli-assets.heroku.com/install.sh | sh
  - echo UN_TOKEN | docker login -u_ --password-stdin registry.heroku.com
  - docker tag francobobadilla/payroll-server:latest registry.heroku.com/payroll-server-bobadilla/web
  - heroku container:push web --app=payroll-server-bobadilla
  - heroku container:release web --app=payroll-server-bobadilla

